## MySQL知识点总结

#### 引擎

- MyISAM

  >- 锁级别为表锁
  >- 读取速度快，存储表的行数
  >- 非聚簇索引
  >- 支持全文索引

- InnoDB

  >- 锁级别为行锁
  >- 支持事务
  >- 支持外键
  >- 聚簇索引


#### 索引

​	**用于提升数据库的查找速度** 

-  [知乎- mysql 索引总结](<https://zhuanlan.zhihu.com/p/29118331>)

索引的数据结构,有两类: 哈希, 树

- 哈希

  >哈希索引采用一定的哈希算法，把键值换算成新的哈希值，可立即定位到相应位置。
  >
  >无法进行排序和范围查询。

- 二叉树

  >二叉树, 均衡二叉树, 红黑树，B树， B+树
  >
  >- 二叉树有可能退化成链表
  >- 树的高度决定了查找性能。高度越低，查找性能越高。1.保证树的均衡，2.多路
  >
  >- 红黑树复杂的定义和规则，都是为了保证树的平衡性
  >- B树可能会涉及中层遍历，B+树可以通过链表

##### 聚集索引和非聚集索引

​	**唯一索引，普通索引都属于辅助索引**

- 聚簇索引

  >- 聚簇索引的叶子节点存储了一行完整的数据
  >- 辅助索引的叶子节点存储了主键值

- 非聚簇索引

  >- 数据文件是分离的，索引保存的是数据文件的指针

##### 索引的使用

> 一般来说，在WHERE和JOIN中出现的列需要建立索引，但也不完全如此，因为MySQL的B-Tree只对<，<=，=，>，>=，BETWEEN，IN，以及不以通配符开始的LIKE才会使用索引。
>
> 使用组合索引替代多个索引列,  需要注意 **最佳左前缀原则**




#### 字符集

[mysql 字符集和排序规则总结](<https://www.cnblogs.com/kerrycode/p/11170266.html>)

##### unicode 与 utf-8, utf-16, utf-32 的关系

> unicode 又称万国码，是一种字符集，国际组织指定的可以容纳世界上所有文字和符号的字符编码方案。
>
> utf-8, utf-16, utf-32 是 unicode 码的一种实现形式，都属于unicode

- `utf8`

  > 不能表达全部的utf-8 ,只能支持"基本多语种平面" ( Basic Multilingual plane, BMP)

- `utf8mb4`

  > mb4 是most bytes 4,可以存储四字节的unicode

##### 排序规则

> 对字符集中字符串之间的比较，排序制定的规则。有如下特征：
>
> - 两个不同的字符集不能有相同的校对规则
> - 每个字符集有一个默认校对规则
> - 存在校对规则命名约定：以其相关的字符集名开始，中间包括一个语言名，并且以`_ci`, `_cs`,`_bin`结束

- `ci` 表示 case insensitive , 大小写不敏感
- `cs` 表示 case sensitive , 大小写敏感
- `bin` 表示使用二进制比较	



#### 数据类型

- 数值型         

  > tinyint                    1 字节
  >
  > int                           4字节
  >
  > bigint                      8 字节
  >
  > float                        4字节
  >
  > double                    8 字节
  >
  > decimal（M，D） 8 字节

  float 和 double 类型主要是为了科学计算和工程计算。是为了在广泛的数值范围上提供较为精确的快速近似的计算而精心设计的。

- 字符型 ： char ,varchar ,text, blob 

  > char(M)  固定长度 （M指字符数，可以省略，默认1）
  >
  > varchar(M)  可变长度 （M 指字符数， 不可以省略） 

- 日期时间型：date, time, year, timestamp, datetime

  > date:  YYYY-mm-dd  3个字节  日期类型
  >
  > time: HH:ii:ss  3个字节  时间类型
  >
  > datetime:YYYY-mm-dd HH:ii:ss   8个字节  日期时间类型
  >
  > timestamp: YYYY-mm-dd HH:ii:ss   4个字节   时间戳类型
  >
  > year: YYYY   1个字节   年类型
  >
  >  在数据库中保存为 timastamp 或者 datetime 类型的数据，在PHP中查询时，需要使用时间字符串进行查询，而且查询结果也是时间字符串。

- null

#### 事务

**ACID**

- 原子性
- 一致性
- 隔离性
- 持久性

##### 隔离级别

- read-uncommited 

  >事务中的修改, 即使未提交, 对其他会话, 也是可见的

- read commited 

  >未提交的事务, 对其他会话不可见 . 会导致非重复读(针对修改)

- repeatable read 

  >导致幻读(针对插入和修改)

##### 约束

- NOT NULL
- DEFAULT

#### 使用规范

- 使用`InnoDB`存储引擎
- 使用 `utf8mb4` 字符集
- 不使用存储过程，触发器，函数等
- 不使用外键约束
- 主键建议自增
- 表名和字段名使用小写字母和下划线， 不使用拼音，表名不使用复数
- 主键索引前缀为pk_ ， 唯一索引前缀uk_, 普通索引前缀为idx_
- 小数类型为decimal

#### 衍生的知识点

- 前序遍历，中序遍历，后序遍历

  >前序遍历：先根，再左，后右
  >
  >中序遍历：先左，再根，后右
  >
  >后序遍历：先左，再右，后根

- 字符

  > 文字和符号的总称，包括文字，图形符号，数字符号等

- 字符集合

  > 指定了一个集合中有哪些字符

- 字符编码

  > 为这个集合中的所有字符定义相关编号

- 字符集

  > 字符集合和编码规则的混合体



